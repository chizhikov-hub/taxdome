<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:TaxDome.AvaloniaApp.Common.Converters"
        xmlns:localization="clr-namespace:TaxDome.AvaloniaApp.Common.Localization"
        xmlns:vm="clr-namespace:TaxDome.AvaloniaApp.Features.DocumentHistory"
        xmlns:sa="clr-namespace:Semi.Avalonia;assembly=Semi.Avalonia"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450" 
        Height="900" Width="1200"
        x:Class="TaxDome.AvaloniaApp.Features.DocumentHistory.DocumentHistoryView"
        x:DataType="vm:DocumentHistoryViewModel"
        Icon="/Assets/Icons/favicon.ico"
        Title="{Binding Path=[Application_Name], Source={x:Static localization:LocalizedStrings.Instance}}">
    <Window.Resources>
        <converters:FileSizeConverter x:Key="FileSizeConverter" />
    </Window.Resources>
    <Window.Styles>
        <Style Selector="TextBlock.Document">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="DemiBold" />
        </Style>
        <Style Selector="TextBlock.FileSize">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Foreground" Value="#6e7681" />
        </Style>
        <Style Selector="TextBlock.Client">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="#5383ef" />
        </Style>
        <Style Selector="TextBlock.Folder">
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Foreground" Value="#6e7681" />
        </Style>
    </Window.Styles>
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" Margin="0,0,0,10" LastChildFill="False">
            <TextBlock DockPanel.Dock="Left" 
                       Text="{Binding Path=[DocumentHistory_Title], Source={x:Static localization:LocalizedStrings.Instance}}" 
                       FontSize="20" 
                       Classes="H2"
                       Theme="{StaticResource TitleTextBlock}"
                       VerticalAlignment="Center"/>
               
            <StackPanel DockPanel.Dock="Right" 
                        Orientation="Horizontal">
                <Button Content="{Binding [DocumentHistory_SelectDocuments], Source={x:Static localization:LocalizedStrings.Instance}}"
                        Classes="Tertiary" 
                        Margin="0,0,10,0" 
                        Padding="10,5"/>
                <Button Content="{Binding [DocumentHistory_UploadFiles], Source={x:Static localization:LocalizedStrings.Instance}}"
                        Command="{Binding AddCommand}"
                        Classes="Primary" 
                        Theme="{DynamicResource SolidButton}"
                        Padding="10,5"/>
            </StackPanel>
        </DockPanel>
        
        <StackPanel Grid.Row="1" Margin="0,0,0,10" Orientation="Horizontal">
            <TextBox 
                Watermark="{Binding [DocumentHistory_SearchTextWatermark], Source={x:Static localization:LocalizedStrings.Instance}}"
                Text="{Binding SearchText}"
                Classes="clearButton"
                MinWidth="400">
                <TextBox.InnerLeftContent>
                    <PathIcon Data="{StaticResource SemiIconSearch}" Width="14" Height="14" Opacity="0.6" />
                </TextBox.InnerLeftContent>
            </TextBox>
            
            <ComboBox PlaceholderText="{Binding [DocumentHistory_AllClients], Source={x:Static localization:LocalizedStrings.Instance}}" Margin="10 0 0 0" MinWidth="200"/>
            
            <ComboBox PlaceholderText="{Binding [DocumentHistory_AllAppliedActions], Source={x:Static localization:LocalizedStrings.Instance}}" Margin="10 0 0 0" MinWidth="200"/>
            
            <ComboBox PlaceholderText="{Binding [DocumentHistory_AllFolders], Source={x:Static localization:LocalizedStrings.Instance}}" Margin="10 0 0 0" MinWidth="200"/>
        </StackPanel>

        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding FilteredItems}"
                  IsReadOnly="True"
                  CanUserReorderColumns="True"
                  CanUserResizeColumns="True"
                  CanUserSortColumns="False"
                  GridLinesVisibility="None">
            <DataGrid.Styles>
                <Style Selector="DataGridRow">
                    <Setter Property="Height" Value="60" />
                </Style>
                
                <Style Selector="DataGridCell">
                    <Setter Property="Padding" Value="10" />
                </Style>
                
                <Style Selector="DataGridColumnHeader">
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="SeparatorBrush" Value="Transparent" />
                </Style>
                
                <Style Selector="DataGrid">
                    <Setter Property="HorizontalGridLinesBrush" Value="Transparent" />
                    <Setter Property="VerticalGridLinesBrush" Value="Transparent" />
                </Style>
                
                <!-- Стиль для строки при наведении -->
                <Style Selector="DataGridRow:pointerover /template/ Rectangle#BackgroundRectangle">
                    <Setter Property="Fill" Value="#15000000"/>
                </Style>
        
                <!-- Стиль для выбранной строки -->
                <Style Selector="DataGridRow:selected /template/ Rectangle#BackgroundRectangle">
                    <Setter Property="Fill" Value="#200078D4"/>
                </Style>
        
                <!-- Стиль для выбранной строки при наведении -->
                <Style Selector="DataGridRow:selected:pointerover /template/ Rectangle#BackgroundRectangle">
                    <Setter Property="Fill" Value="#300078D4"/>
                </Style>
                
                <Style Selector="DataGridCell">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="Template">
                        <ControlTemplate>
                            <Grid Background="{TemplateBinding Background}">
                                <ContentPresenter Margin="{TemplateBinding Padding}"
                                                  Content="{TemplateBinding Content}"
                                                  ContentTemplate="{TemplateBinding ContentTemplate}"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                            </Grid>
                        </ControlTemplate>
                    </Setter>
                </Style>
            </DataGrid.Styles>
            <DataGrid.Columns>
                <DataGridTemplateColumn
                    Header="{Binding [DocumentHistory_Column_Document], Source={x:Static localization:LocalizedStrings.Instance}}"
                    Width="1.5*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Document}"
                                           Classes="Document" />
                                <TextBlock Text="{Binding FileSize, Converter={StaticResource FileSizeConverter}}"
                                           Classes="FileSize" />
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn
                    Header="{Binding [DocumentHistory_Column_ClientAndFolder], Source={x:Static localization:LocalizedStrings.Instance}}"
                    Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Client.Name}"
                                           Classes="Client" />
                                <TextBlock Text="{Binding Folder.Name}"
                                           Classes="Folder" />
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn
                    Header="{Binding [DocumentHistory_Column_AppliedActions], Source={x:Static localization:LocalizedStrings.Instance}}"
                    Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel></StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTemplateColumn
                    Header="{Binding [DocumentHistory_Column_AvailableActions], Source={x:Static localization:LocalizedStrings.Instance}}"
                    Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel></StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>


                <!-- <DataGridTextColumn -->
                <!--     Header="DateGroup" -->
                <!--     Binding="{Binding DateGroup}" -->
                <!-- /> -->

            </DataGrid.Columns>
        </DataGrid>

        <Panel Grid.Row="2"
               IsVisible="{Binding IsLoading}">
            <Panel Background="Black" Opacity="0.2"/>
            <ProgressBar IsIndeterminate="True"
                        Width="200"
                        Height="20"
                        VerticalAlignment="Center"
                        HorizontalAlignment="Center"/>
        </Panel>
    </Grid>
</Window>